<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Defend the Donuts!</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: var(--main-font);
            overflow: hidden;
            user-select: none;
        }
        
        audio { display:none; }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-image: url('counterGPT.png');
            background-size: cover;
        }
        
        #lives-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-wrap: wrap;
            width: 180px;
            justify-content: center;
        }
        
        .donut {
            width: 60px;
            height: 60px;
            margin: 15px;
            transition: all 0.3s;
            background-image: url('FOOD.png');
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        .raccoon {
            position: absolute;
            width: 60px;
            height: 60px;
            cursor: pointer;
            transition: transform 0.1s;
            background-image: url('rac-left.png');
            background-size: contain;
            background-repeat: no-repeat;
            z-index: 10;
        }
        
        .raccoon:hover {
            transform: scale(1.2);
        }
        
        .employee {
            position: absolute;
            width: 90px;
            height: 90px;
            cursor: move;
            background-size: contain;
            background-repeat: no-repeat;
            z-index: 10;
        }
        
        .employee-type1 { background-image: url('employee1.png'); }
        .employee-type2 { background-image: url('employee2.png'); }
        .employee-type3 { background-image: url('employee3.png'); }
        
        .bullet {
            position: absolute;
            width: 25px;
            height: 25px;
            background-image: url('bullet.png');
            background-size: contain;
            background-repeat: no-repeat;
            z-index: 5;
        }
        
        .trash {
            position: absolute;
            width: 25px;
            height: 25px;
            background-image: url('trash.png');
            background-size: contain;
            background-repeat: no-repeat;
            z-index: 5;
        }
        
        .health-bar-container {
            position: absolute;
            width: 90px;
            height: 8px;
            top: -12px;
            left: 0;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }
        
        .health-bar {
            height: 100%;
            border-radius: 4px;
            transition: width 0.2s;
        }
        
        .raccoon-health { background-color: #ff6b6b; }
        .employee-health { background-color: #4CAF50; }
        
        #employee-menu {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            background-color: rgba(255, 255, 255, 0.7);
            padding: 10px;
            border-radius: 10px;
            z-index: 20;
        }
        
        .menu-employee {
            width: 60px;
            height: 60px;
            cursor: grab;
            padding: 5px;
            border-radius: 5px;
            background-size: contain;
            background-repeat: no-repeat;
            position: relative;
        }
        
        .employee-count-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #b14d34;
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .menu-employee:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }
        
        #score-display {
            position: absolute;
            top: 30px;
            right: 30px;
            font-size: 32px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            z-index: 20;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        /* Rest of your existing styles... */
    </style>
</head>
<body>
    <audio loop autoplay id="audioplayer">
        <source src="Background_music.mp3" type="audio/mpeg">
    </audio>
    
    <div id="game-container">
        <!-- Your existing game container content -->
        
        <div id="employee-menu">
            <div class="menu-employee menu-employee-type1" draggable="true" data-type="1">
                <div class="employee-count-badge" id="employee1-count">0</div>
            </div>
            <div class="menu-employee menu-employee-type2" draggable="true" data-type="2">
                <div class="employee-count-badge" id="employee2-count">0</div>
            </div>
            <div class="menu-employee menu-employee-type3" draggable="true" data-type="3">
                <div class="employee-count-badge" id="employee3-count">0</div>
            </div>
        </div>
        
        <!-- Rest of your HTML -->
    </div>

    <script>
        // Initialize game state with employee counts
        const gameState = {
            employeeCounts: {
                type1: parseInt(localStorage.getItem('employee1Count')) || 0,
                type2: parseInt(localStorage.getItem('employee2Count')) || 0,
                type3: parseInt(localStorage.getItem('employee3Count')) || 0
            }
            // ... rest of your game state
        };

        // Process gacha results on game start
        function processGachaResult() {
            const stored = JSON.parse(localStorage.getItem('lastPullResult'));
            if (!stored) return;

            const {type, value} = stored;
            
            if (type === 'number' && !isNaN(value)) {
                const current = parseInt(localStorage.getItem('totalRaccoonsCaught')) || 0;
                localStorage.setItem('totalRaccoonsCaught', current + value);
            }
            else if (type === 'string') {
                switch(value) {
                    case 'casher':
                        gameState.employeeCounts.type1++;
                        localStorage.setItem('employee1Count', gameState.employeeCounts.type1);
                        break;
                    case 'manager':
                        gameState.employeeCounts.type2++;
                        localStorage.setItem('employee2Count', gameState.employeeCounts.type2);
                        break;
                    case 'boss':
                        gameState.employeeCounts.type3++;
                        localStorage.setItem('employee3Count', gameState.employeeCounts.type3);
                        break;
                }
            }
            localStorage.removeItem('lastPullResult');
            updateEmployeeDisplays();
        }

        // Update employee displays
        function updateEmployeeDisplays() {
            document.getElementById('employee1-count').textContent = gameState.employeeCounts.type1;
            document.getElementById('employee2-count').textContent = gameState.employeeCounts.type2;
            document.getElementById('employee3-count').textContent = gameState.employeeCounts.type3;
            
            document.querySelector('[data-type="1"]').style.display = 
                gameState.employeeCounts.type1 > 0 ? 'block' : 'none';
            document.querySelector('[data-type="2"]').style.display = 
                gameState.employeeCounts.type2 > 0 ? 'block' : 'none';
            document.querySelector('[data-type="3"]').style.display = 
                gameState.employeeCounts.type3 > 0 ? 'block' : 'none';
        }

        // Initialize
        processGachaResult();
        updateEmployeeDisplays();

        // Rest of your game logic...
    </script>
</body>
</html>